<!DOCTYPE html>
<html>
<head>
    <title>API Test - Business Daily Deals</title>
</head>
<body>
    <h2>Testing API Endpoints</h2>
    <div id="results"></div>
    
    <script>
    async function testAPI() {
        const results = document.getElementById('results');
        results.innerHTML = '<p>üîç Testing server status...</p>';
        
        try {
            // Test if server is running at all
            results.innerHTML += '<h3>Step 1: Testing if server is running</h3>';
            const healthRes = await fetch('/api/health');
            
            if (!healthRes.ok) {
                throw new Error(`Server returned ${healthRes.status}: ${healthRes.statusText}`);
            }
            
            const healthData = await healthRes.json();
            results.innerHTML += '<pre style="background: #e8f5e8; padding: 10px;">' + JSON.stringify(healthData, null, 2) + '</pre>';
            results.innerHTML += '<p><strong>‚úÖ Server is running!</strong></p>';
            
            // Test deals API
            results.innerHTML += '<h3>Step 2: Testing deals API</h3>';
            const dealsRes = await fetch('/api/deals?type=hot');
            
            if (!dealsRes.ok) {
                throw new Error(`Deals API returned ${dealsRes.status}: ${dealsRes.statusText}`);
            }
            
            const hotData = await dealsRes.json();
            results.innerHTML += '<p><strong>Hot deals found: ' + hotData.length + '</strong></p>';
            
            if (hotData.length > 0) {
                results.innerHTML += '<h4>Sample deal data:</h4>';
                results.innerHTML += '<pre style="background: #e8f5e8; padding: 10px;">' + JSON.stringify(hotData[0], null, 2) + '</pre>';
                results.innerHTML += '<h2 style="color: green;">‚úÖ Everything Working! Hot deals should load.</h2>';
            } else {
                results.innerHTML += '<h2 style="color: orange;">‚ö†Ô∏è Server running but no deals data</h2>';
            }
            
        } catch (error) {
            results.innerHTML += '<h2 style="color: red;">‚ùå Server Issue: ' + error.message + '</h2>';
            results.innerHTML += '<p>Possible causes:</p>';
            results.innerHTML += '<ul>';
            results.innerHTML += '<li>Node.js app not started in cPanel</li>';
            results.innerHTML += '<li>Wrong entry point (should be app.js)</li>';
            results.innerHTML += '<li>Port binding issues</li>';
            results.innerHTML += '<li>Missing dependencies (run npm install)</li>';
            results.innerHTML += '</ul>';
        }
    }
    
    testAPI();
    </script>
</body>
</html>